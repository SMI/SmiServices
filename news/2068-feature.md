Refactor message Ack/Nack using events